(()=>{"use strict";var e={56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var s={},a=[],o=0;o<e.length;o++){var l=e[o],d=r.base?l[0]+r.base:l[0],c=s[d]||0,h="".concat(d," ").concat(c);s[d]=c+1;var m=n(h),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==m)t[m].references++,t[m].updater(u);else{var p=i(u,r);r.byIndex=o,t.splice(o,0,{identifier:h,updater:p,references:1})}a.push(h)}return a}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var s=r(e=e||[],i=i||{});return function(e){e=e||[];for(var a=0;a<s.length;a++){var o=n(s[a]);t[o].references--}for(var l=r(e,i),d=0;d<s.length;d++){var c=n(s[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}s=l}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},115:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(601),i=n.n(r),s=n(314),a=n.n(s)()(i());a.push([e.id,"/* filepath: c:\\Users\\BenoitRobin\\JsTimeline\\v2-vscode\\timeline-animation-editor\\src\\styles\\timeline.css */\n\n:root {\n    --time-ruler-height: 30px;\n    --layer-item-height: 40px;\n    --keyframe-size: 12px;\n    --timeline-bg-color: #2a2a2a;\n    --timeline-border-color: #444;\n    --timeline-text-color: #ddd;\n    --timeline-accent-color: #4c9ffe;\n    --ruler-bg-color: #222;\n    --ruler-marker-color: #666;\n    --ruler-marker-major-color: #888;\n    --layer-bg-color: #333;\n    --layer-alt-bg-color: #383838;\n    --layer-selected-color: #4c9ffe33;\n    --keyframe-color: #fc0;\n    --keyframe-selected-color: #f00;\n    --toolbar-bg-color: #333;\n}\n\n/* Main Timeline Layout */\n.timeline-control {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n    background-color: var(--timeline-bg-color);\n    color: var(--timeline-text-color);\n    border: 1px solid var(--timeline-border-color);\n    overflow: hidden;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    font-size: 14px;\n}\n\n/* Toolbar Styling */\n.timeline-toolbar {\n    display: flex;\n    align-items: center;\n    height: 40px;\n    background-color: var(--toolbar-bg-color);\n    border-bottom: 1px solid var(--timeline-border-color);\n    padding: 0 10px;\n}\n\n/* Main Content Area */\n.timeline-content {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    overflow: hidden;\n}\n\n.timeline-content-container {\n    display: flex;\n    flex: 1;\n    overflow: hidden;\n}\n\n/* Layers Container (Left Panel) */\n.timeline-layers-container {\n    width: 200px;\n    height: 100%;\n    overflow-y: auto;\n    overflow-x: hidden;\n    border-right: 1px solid var(--timeline-border-color);\n    background-color: var(--layer-bg-color);\n}\n\n/* Keyframes Area (Right Panel) */\n.timeline-keyframes-area {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    overflow: hidden;\n}\n\n/* Time Ruler */\n.timeline-ruler {\n    height: var(--time-ruler-height);\n    overflow: hidden;\n    position: relative;\n    background-color: var(--ruler-bg-color);\n    border-bottom: 1px solid var(--timeline-border-color);\n}\n\n.timeline-ruler-content {\n    position: relative;\n    height: 100%;\n    min-width: 100%;\n    will-change: transform;\n}\n\n/* Keyframes Container */\n.timeline-keyframes-container {\n    flex: 1;\n    overflow: auto;\n    position: relative;\n    background-color: var(--timeline-bg-color);\n}\n\n/* Object Toolbar (Bottom) */\n.timeline-object-toolbar {\n    height: 40px;\n    background-color: var(--toolbar-bg-color);\n    border-top: 1px solid var(--timeline-border-color);\n    padding: 0 10px;\n    display: flex;\n    align-items: center;\n}\n\n/* Scrollbar Styling */\n.timeline-layers-container::-webkit-scrollbar,\n.timeline-keyframes-container::-webkit-scrollbar {\n    width: 10px;\n    height: 10px;\n}\n\n.timeline-layers-container::-webkit-scrollbar-track,\n.timeline-keyframes-container::-webkit-scrollbar-track {\n    background: var(--timeline-bg-color);\n}\n\n.timeline-layers-container::-webkit-scrollbar-thumb,\n.timeline-keyframes-container::-webkit-scrollbar-thumb {\n    background: var(--timeline-border-color);\n    border-radius: 4px;\n}\n\n.timeline-layers-container::-webkit-scrollbar-thumb:hover,\n.timeline-keyframes-container::-webkit-scrollbar-thumb:hover {\n    background: var(--timeline-accent-color);\n}\n",""]);const o=a},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,s){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(a[l]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);r&&a[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},754:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(601),i=n.n(r),s=n(314),a=n.n(s)()(i());a.push([e.id,"/* filepath: c:\\Users\\BenoitRobin\\JsTimeline\\v2-vscode\\timeline-animation-editor\\src\\styles\\components.css */\n\n/* Time Ruler Components */\n.time-marker {\n    position: absolute;\n    top: 0;\n    height: 100%;\n    pointer-events: none;\n}\n\n.time-marker.major {\n    height: 100%;\n    border-left: 1px solid var(--ruler-marker-major-color);\n}\n\n.time-marker.minor {\n    height: 40%;\n    bottom: 0;\n    border-left: 1px solid var(--ruler-marker-color);\n}\n\n.time-marker-label {\n    position: absolute;\n    top: 2px;\n    transform: translateX(-50%);\n    font-size: 11px;\n    color: var(--timeline-text-color);\n    white-space: nowrap;\n}\n\n/* Layer Components */\n.layer-item {\n    height: var(--layer-item-height);\n    display: flex;\n    align-items: center;\n    padding: 0 10px;\n    border-bottom: 1px solid var(--timeline-border-color);\n    user-select: none;\n    cursor: pointer;\n}\n\n.layer-item:nth-child(odd) {\n    background-color: var(--layer-bg-color);\n}\n\n.layer-item:nth-child(even) {\n    background-color: var(--layer-alt-bg-color);\n}\n\n.layer-item.selected {\n    background-color: var(--layer-selected-color);\n}\n\n.layer-name {\n    flex: 1;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n}\n\n.layer-controls {\n    display: flex;\n    gap: 5px;\n    opacity: 0;\n    transition: opacity 0.2s;\n}\n\n.layer-item:hover .layer-controls {\n    opacity: 1;\n}\n\n.add-layer-btn, \n.rename-layer-btn, \n.delete-layer-btn {\n    background: transparent;\n    border: 1px solid var(--timeline-border-color);\n    color: var(--timeline-text-color);\n    padding: 2px 6px;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 12px;\n}\n\n.add-layer-btn:hover, \n.rename-layer-btn:hover, \n.delete-layer-btn:hover {\n    background-color: var(--timeline-accent-color);\n    color: #fff;\n}\n\n/* Keyframe Components */\n.layer-keyframes {\n    height: var(--layer-item-height);\n    position: relative;\n    border-bottom: 1px solid var(--timeline-border-color);\n}\n\n.layer-keyframes:nth-child(odd) {\n    background-color: var(--layer-bg-color);\n}\n\n.layer-keyframes:nth-child(even) {\n    background-color: var(--layer-alt-bg-color);\n}\n\n.keyframe {\n    position: absolute;\n    width: var(--keyframe-size);\n    height: var(--keyframe-size);\n    background-color: var(--keyframe-color);\n    border-radius: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n    cursor: grab;\n    z-index: 10;\n}\n\n.keyframe.selected {\n    background-color: var(--keyframe-selected-color);\n    box-shadow: 0 0 0 2px white;\n}\n\n.keyframe:active {\n    cursor: grabbing;\n}\n\n/* Group Components */\n.group-item {\n    border-bottom: 1px solid var(--timeline-border-color);\n    user-select: none;\n}\n\n.group-header {\n    display: flex;\n    align-items: center;\n    height: var(--layer-item-height);\n    padding: 0 10px;\n    background-color: var(--timeline-accent-color);\n    color: white;\n    cursor: pointer;\n}\n\n.expand-toggle {\n    margin-right: 5px;\n}\n\n.group-name {\n    flex: 1;\n    font-weight: bold;\n}\n\n.group-controls {\n    display: flex;\n    gap: 5px;\n    opacity: 0;\n    transition: opacity 0.2s;\n}\n\n.group-header:hover .group-controls {\n    opacity: 1;\n}\n\n.group-layers {\n    overflow: hidden;\n    transition: max-height 0.3s;\n}\n\n.group-layers.expanded {\n    max-height: 1000px; /* Arbitrary large value */\n}\n\n.group-layers.collapsed {\n    max-height: 0;\n}\n\n.group-layer {\n    display: flex;\n    align-items: center;\n    height: var(--layer-item-height);\n    padding: 0 10px 0 30px; /* Indented */\n    border-bottom: 1px solid var(--timeline-border-color);\n    background-color: var(--layer-bg-color);\n}\n\n/* Group Context Menu */\n.group-context-menu {\n    position: fixed;\n    background-color: var(--toolbar-bg-color);\n    border: 1px solid var(--timeline-border-color);\n    border-radius: 4px;\n    z-index: 1000;\n    min-width: 150px;\n    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);\n}\n\n.menu-title {\n    padding: 8px 12px;\n    font-weight: bold;\n    border-bottom: 1px solid var(--timeline-border-color);\n}\n\n.menu-item {\n    padding: 8px 12px;\n    cursor: pointer;\n}\n\n.menu-item:hover {\n    background-color: var(--timeline-accent-color);\n    color: white;\n}\n\n/* Toolbar Components */\n.toolbar-button {\n    background: transparent;\n    border: 1px solid var(--timeline-border-color);\n    color: var(--timeline-text-color);\n    padding: 5px 10px;\n    border-radius: 4px;\n    cursor: pointer;\n    margin: 0 5px;\n}\n\n.toolbar-button:hover {\n    background-color: var(--timeline-accent-color);\n    color: white;\n}\n\n.toolbar-separator {\n    height: 20px;\n    width: 1px;\n    background-color: var(--timeline-border-color);\n    margin: 0 10px;\n}\n\n.timeline-zoom-control {\n    display: flex;\n    align-items: center;\n    gap: 5px;\n}\n\n.zoom-value {\n    width: 40px;\n    text-align: center;\n}\n",""]);const o=a},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,exports:{}};return e[r](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;const r="timeline-ruler-content";class i{constructor(e,t){this.container=e,this.elementId=t}}const s="timeUpdated",a="zoomChanged",o="layerAdded",l="layerRemoved",d="layerRenamed",c="layerSelected",h="keyframeAdded",m="keyframeMoved",u="dataChanged";class p extends i{constructor(e){super(e.container,"time-ruler"),this.pixelsPerSecond=100,this.dependencies=[],this.name="timeRuler",this.eventEmitter=e.eventEmitter,this.duration=e.duration||60,this.timeScale=e.timeScale||1}initialize(){this.render(),this.setupEventListeners(),this.eventEmitter.on(a,this,this.onZoomChange)}onZoomChange(e){this.timeScale=e,this.render()}render(){const e=`\n            <div class="${r}">\n                ${this.generateTimeMarkers()}\n            </div>\n        `;return this.container.innerHTML=e,e}generateTimeMarkers(){let e="";const t=this.duration*this.timeScale*this.pixelsPerSecond;let n=1;this.timeScale<.5&&(n=5),this.timeScale<.2&&(n=10),this.timeScale<.1&&(n=30);const i=n/5;for(let t=0;t<=this.duration;t+=n)e+=`\n                <div class="time-marker major" style="left: ${t*this.timeScale*this.pixelsPerSecond}px;">\n                    <div class="time-marker-label">${this.formatTime(t)}</div>\n                </div>\n            `;for(let t=0;t<=this.duration;t+=i)t%n!=0&&(e+=`\n                <div class="time-marker minor" style="left: ${t*this.timeScale*this.pixelsPerSecond}px;"></div>\n            `);return setTimeout((()=>{const e=this.container.querySelector("."+r);e&&(e.style.width=`${t}px`)}),0),e}formatTime(e){return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}update(e){const t=this.container.querySelector("."+r);t&&(t.style.transform=`translateX(-${e}px)`)}updateDuration(e){this.duration=e,this.render()}updateTimeScale(e){this.timeScale=e,this.render()}setupEventListeners(){this.container.addEventListener("click",this.handleClick.bind(this))}handleClick(e){const t=this.container.getBoundingClientRect(),n=e.clientX-t.left,i=this.container.querySelector("."+r);let a=0;if(i){const e=i.style.transform.match(/translateX\(-(\d+)px\)/);e&&(a=parseInt(e[1],10))}const o=(n+a)/(this.timeScale*this.pixelsPerSecond);this.eventEmitter.emit(s,{time:o})}destroy(){this.container.removeEventListener("click",this.handleClick.bind(this)),this.eventEmitter.off(a,this.onZoomChange)}}class y extends i{constructor(e){super(e.container,"layer-manager"),this.layers=[],this.selectedLayerId=null,this.name="layerManager",this.dependencies=[],this.eventEmitter=e.eventEmitter}initialize(){this.render(),this.setupEventListeners(),this.eventEmitter.on(o,this,this.handleLayerAdded),this.eventEmitter.on(l,this,this.handleLayerRemoved),this.eventEmitter.on(d,this,this.handleLayerRenamed)}render(){const e=`\n            <div class="layer-manager">\n                <div class="layer-tools">\n                    <button class="add-layer-btn">Add Layer</button>\n                </div>\n                <div class="layer-list">\n                    ${this.renderLayers()}\n                </div>\n            </div>\n        `;return this.container.innerHTML=e,e}renderLayers(){return 0===this.layers.length?'<div class="no-layers-message">No layers. Click "Add Layer" to create one.</div>':this.layers.map(((e,t)=>`\n            <div class="layer-item ${this.selectedLayerId===e.id?"selected":""}" \n                 data-layer-id="${e.id}" \n                 data-index="${t}">\n                <div class="layer-name">${e.name}</div>\n                <div class="layer-controls">\n                    <button class="rename-layer-btn" data-layer-id="${e.id}">Rename</button>\n                    <button class="delete-layer-btn" data-layer-id="${e.id}">Delete</button>\n                </div>\n            </div>\n        `)).join("")}update(e){this.layers=e.layers,this.render()}selectLayer(e){this.selectedLayerId=e,this.container.querySelectorAll(".layer-item").forEach((t=>{t.dataset.layerId===e?t.classList.add("selected"):t.classList.remove("selected")})),this.eventEmitter.emit(c,{layerId:e})}setupEventListeners(){this.container.addEventListener("click",(e=>{const t=e.target.closest(".layer-item");if(t){const e=t.dataset.layerId;e&&this.selectLayer(e)}})),this.container.addEventListener("click",(e=>{e.target.classList.contains("add-layer-btn")&&this.addLayer()})),this.container.addEventListener("click",(e=>{const t=e.target;if(t.classList.contains("delete-layer-btn")){const e=t.dataset.layerId;e&&this.deleteLayer(e)}})),this.container.addEventListener("click",(e=>{const t=e.target;if(t.classList.contains("rename-layer-btn")){const e=t.dataset.layerId;e&&this.promptRenameLayer(e)}})),this.setupDragAndDrop()}addLayer(){const e="layer_"+Date.now(),t={id:e,name:`Layer ${this.layers.length+1}`,keyframes:[]};this.layers.push(t),this.eventEmitter.emit(o,{layer:t}),this.render(),this.selectLayer(e)}deleteLayer(e){this.layers=this.layers.filter((t=>t.id!==e)),this.eventEmitter.emit(l,{layerId:e}),this.render(),this.selectedLayerId===e&&(this.selectedLayerId=this.layers.length>0?this.layers[0].id:null,this.selectedLayerId&&this.selectLayer(this.selectedLayerId))}promptRenameLayer(e){const t=this.layers.find((t=>t.id===e));if(!t)return;const n=prompt(`Rename layer "${t.name}" to:`,t.name);null!==n&&""!==n.trim()&&this.renameLayer(e,n)}renameLayer(e,t){const n=this.layers.find((t=>t.id===e));n&&(n.name=t,this.eventEmitter.emit(d,{layerId:e,newName:t}),this.render())}setupDragAndDrop(){}handleLayerAdded(e){this.layers.some((t=>t.id===e.layer.id))||(this.layers.push(e.layer),this.render())}handleLayerRemoved(e){this.layers=this.layers.filter((t=>t.id!==e.layerId)),this.render()}handleLayerRenamed(e){const t=this.layers.find((t=>t.id===e.layerId));t&&(t.name=e.newName,this.render())}destroy(){this.eventEmitter.off(o,this.handleLayerAdded),this.eventEmitter.off(l,this.handleLayerRemoved),this.eventEmitter.off(d,this.handleLayerRenamed)}}class g extends i{constructor(e){super(e.container,"keyframe-manager"),this.layers=[],this.selectedKeyframeId=null,this.selectedLayerId=null,this.isDragging=!1,this.dragStartX=0,this.dragKeyframeId=null,this.name="keyframeManager",this.dependencies=[{name:"layerManager",optional:!1},{name:"timeRuler",optional:!1}],this.eventEmitter=e.eventEmitter,this.timeScale=e.timeScale||1,this.pixelsPerSecond=e.pixelsPerSecond||100}initialize(){this.render(),this.setupEventListeners(),this.eventEmitter.on(o,this,this.handleLayerAdded),this.eventEmitter.on(l,this,this.handleLayerRemoved),this.eventEmitter.on(c,this,this.handleLayerSelected),this.eventEmitter.on(s,this,this.handleTimeUpdated),this.eventEmitter.on(a,this,this.handleZoomChanged)}render(){const e=`\n            <div class="keyframe-manager">\n                ${this.renderKeyframeContainer()}\n            </div>\n        `;return this.container.innerHTML=e,e}renderKeyframeContainer(){return this.layers.map((e=>`\n            <div class="layer-keyframes" data-layer-id="${e.id}">\n                ${this.renderKeyframesForLayer(e)}\n            </div>\n        `)).join("")}renderKeyframesForLayer(e){return e.keyframes&&0!==e.keyframes.length?e.keyframes.map((e=>{const t=this.calculateKeyframePosition(e.time);return`\n                <div class="keyframe ${e.id===this.selectedKeyframeId?"selected":""}" \n                     data-keyframe-id="${e.id}"\n                     data-time="${e.time}"\n                     style="left: ${t}px;">\n                </div>\n            `})).join(""):""}calculateKeyframePosition(e){return e*this.timeScale*this.pixelsPerSecond}update(e){this.layers=e.layers,this.render()}setupEventListeners(){this.container.addEventListener("dblclick",this.handleDoubleClick.bind(this)),this.container.addEventListener("click",this.handleClick.bind(this)),this.container.addEventListener("mousedown",this.handleMouseDown.bind(this)),document.addEventListener("mousemove",this.handleMouseMove.bind(this)),document.addEventListener("mouseup",this.handleMouseUp.bind(this))}handleDoubleClick(e){if(null===this.selectedLayerId)return void alert("Please select a layer first");const t=e.target;if(t.classList.contains("layer-keyframes")){const n=t.dataset.layerId;if(n===this.selectedLayerId){const r=t.getBoundingClientRect(),i=(e.clientX-r.left)/(this.timeScale*this.pixelsPerSecond);this.createKeyframe(n,i)}}}handleClick(e){const t=e.target;if(t.classList.contains("keyframe")){const e=t.dataset.keyframeId;e&&this.selectKeyframe(e)}}handleMouseDown(e){const t=e.target;t.classList.contains("keyframe")&&(this.isDragging=!0,this.dragStartX=e.clientX,this.dragKeyframeId=t.dataset.keyframeId||null,e.preventDefault())}handleMouseMove(e){if(!this.isDragging||null===this.dragKeyframeId)return;const t=e.clientX-this.dragStartX,n=this.container.querySelector(`[data-keyframe-id="${this.dragKeyframeId}"]`);if(n){const r=parseInt(n.style.left||"0",10);n.style.left=`${r+t}px`,this.dragStartX=e.clientX}}handleMouseUp(e){if(!this.isDragging||null===this.dragKeyframeId)return;const t=this.container.querySelector(`[data-keyframe-id="${this.dragKeyframeId}"]`);if(t){const e=parseInt(t.style.left||"0",10)/(this.timeScale*this.pixelsPerSecond);this.updateKeyframeTime(this.dragKeyframeId,e)}this.isDragging=!1,this.dragKeyframeId=null}createKeyframe(e,t){const n=this.layers.find((t=>t.id===e));if(!n)return;const r="keyframe_"+Date.now(),i={id:r,time:t,value:{}};n.keyframes||(n.keyframes=[]),n.keyframes.push(i),this.eventEmitter.emit(h,{layerId:e,keyframe:i}),this.render(),this.selectKeyframe(r)}selectKeyframe(e){var t;this.selectedKeyframeId=e,this.container.querySelectorAll(".keyframe").forEach((t=>{t.dataset.keyframeId===e?t.classList.add("selected"):t.classList.remove("selected")}));let n=null,r=null;for(const i of this.layers){const s=null===(t=i.keyframes)||void 0===t?void 0:t.find((t=>t.id===e));if(s){n=s,r=i.id;break}}n&&r&&this.eventEmitter.emit("keyframeSelected",{keyframe:n,layerId:r})}updateKeyframeTime(e,t){var n,r;for(const i of this.layers){const s=null!==(r=null===(n=i.keyframes)||void 0===n?void 0:n.findIndex((t=>t.id===e)))&&void 0!==r?r:-1;if(-1!==s&&i.keyframes){i.keyframes[s].time=t,this.eventEmitter.emit(m,{layerId:i.id,keyframeId:e,newTime:t});break}}this.render()}handleLayerAdded(e){this.layers.some((t=>t.id===e.layer.id))||(this.layers.push(e.layer),this.render())}handleLayerRemoved(e){this.layers=this.layers.filter((t=>t.id!==e.layerId)),this.render()}handleLayerSelected(e){this.selectedLayerId=e.layerId}handleTimeUpdated(e){}handleZoomChanged(e){this.timeScale=e.scale,this.render()}destroy(){this.container.removeEventListener("dblclick",this.handleDoubleClick.bind(this)),this.container.removeEventListener("click",this.handleClick.bind(this)),this.container.removeEventListener("mousedown",this.handleMouseDown.bind(this)),document.removeEventListener("mousemove",this.handleMouseMove.bind(this)),document.removeEventListener("mouseup",this.handleMouseUp.bind(this)),this.eventEmitter.off(o,this.handleLayerAdded),this.eventEmitter.off(l,this.handleLayerRemoved),this.eventEmitter.off(c,this.handleLayerSelected),this.eventEmitter.off(s,this.handleTimeUpdated),this.eventEmitter.off(a,this.handleZoomChanged)}}class f extends i{constructor(e){super(e.container,"group-manager"),this.groups=[],this.layers=[],this.selectedGroupId=null,this.name="groupManager",this.dependencies=[{name:"layerManager",optional:!1}],this.eventEmitter=e.eventEmitter}initialize(){this.setupEventListeners(),this.eventEmitter.on(o,this,this.handleLayerAdded),this.eventEmitter.on(l,this,this.handleLayerRemoved)}render(){return""}renderGroupControls(){return`\n            <div class="group-controls">\n                <button class="create-group-btn">Create Group</button>\n                <div class="group-list">\n                    ${this.renderGroupList()}\n                </div>\n            </div>\n        `}renderGroupList(){return 0===this.groups.length?'<div class="no-groups-message">No groups</div>':this.groups.map((e=>`\n            <div class="group-item ${this.selectedGroupId===e.id?"selected":""}" \n                 data-group-id="${e.id}">\n                <div class="group-header">\n                    <span class="expand-toggle ${e.expanded?"expanded":"collapsed"}">\n                        ${e.expanded?"▼":"►"}\n                    </span>\n                    <span class="group-name">${e.name}</span>\n                    <div class="group-controls">\n                        <button class="rename-group-btn" data-group-id="${e.id}">Rename</button>\n                        <button class="delete-group-btn" data-group-id="${e.id}">Delete</button>\n                    </div>\n                </div>\n                <div class="group-layers ${e.expanded?"expanded":"collapsed"}">\n                    ${this.renderGroupLayers(e)}\n                </div>\n            </div>\n        `)).join("")}renderGroupLayers(e){return 0===e.layerIds.length?'<div class="no-layers-message">No layers in this group</div>':this.layers.filter((t=>e.layerIds.includes(t.id))).map((t=>`\n            <div class="group-layer" data-layer-id="${t.id}">\n                ${t.name}\n                <button class="remove-from-group-btn" \n                       data-group-id="${e.id}" \n                       data-layer-id="${t.id}">\n                    Remove\n                </button>\n            </div>\n        `)).join("")}update(e){this.layers=e.layers,this.groups=e.groups,this.updateGroupUI()}updateGroupUI(){let e=this.container.querySelector(".group-controls");if(e)e.innerHTML=this.renderGroupList();else{const t=this.renderGroupControls(),n=document.createElement("div");n.innerHTML=t,this.container.appendChild(n.firstElementChild),e=this.container.querySelector(".group-controls")}}setupEventListeners(){this.container.addEventListener("click",(e=>{const t=e.target;if(t.classList.contains("create-group-btn"))this.createGroup();else if(t.classList.contains("rename-group-btn")){const e=t.dataset.groupId;e&&this.promptRenameGroup(e)}else if(t.classList.contains("delete-group-btn")){const e=t.dataset.groupId;e&&this.deleteGroup(e)}else if(t.classList.contains("remove-from-group-btn")){const e=t.dataset.groupId,n=t.dataset.layerId;e&&n&&this.removeLayerFromGroup(e,n)}else if(t.classList.contains("expand-toggle")){const e=t.closest(".group-item");if(e){const t=e.dataset.groupId;t&&this.toggleGroupExpanded(t)}}})),this.container.addEventListener("contextmenu",(e=>{const t=e.target.closest(".layer-item");if(t){e.preventDefault();const n=t.dataset.layerId;n&&this.showAddToGroupMenu(n,e.clientX,e.clientY)}}))}createGroup(){const e={id:"group_"+Date.now(),name:`Group ${this.groups.length+1}`,layerIds:[],expanded:!0};this.groups.push(e),this.updateGroupUI()}promptRenameGroup(e){const t=this.groups.find((t=>t.id===e));if(!t)return;const n=prompt(`Rename group "${t.name}" to:`,t.name);null!==n&&""!==n.trim()&&this.renameGroup(e,n)}renameGroup(e,t){const n=this.groups.find((t=>t.id===e));n&&(n.name=t,this.updateGroupUI())}deleteGroup(e){this.groups=this.groups.filter((t=>t.id!==e)),this.updateGroupUI()}toggleGroupExpanded(e){const t=this.groups.find((t=>t.id===e));t&&(t.expanded=!t.expanded,this.updateGroupUI())}addLayerToGroup(e,t){const n=this.groups.find((t=>t.id===e));n&&!n.layerIds.includes(t)&&(n.layerIds.push(t),this.updateGroupUI())}removeLayerFromGroup(e,t){const n=this.groups.find((t=>t.id===e));n&&(n.layerIds=n.layerIds.filter((e=>e!==t)),this.updateGroupUI())}showAddToGroupMenu(e,t,n){const r=document.querySelector(".group-context-menu");r&&document.body.removeChild(r);const i=`\n            <div class="group-context-menu" style="left: ${t}px; top: ${n}px;">\n                <div class="menu-title">Add to Group</div>\n                ${0===this.groups.length?'<div class="no-groups-menu-item">No groups available</div>':this.groups.map((t=>`\n                        <div class="menu-item add-to-group-item" \n                             data-group-id="${t.id}" \n                             data-layer-id="${e}">\n                            ${t.name}\n                        </div>\n                    `)).join("")}\n                <div class="menu-item create-group-item">Create new group</div>\n            </div>\n        `,s=document.createElement("div");s.innerHTML=i;const a=s.firstElementChild;document.body.appendChild(a),a.addEventListener("click",(t=>{const n=t.target;if(n.classList.contains("add-to-group-item")){const e=n.dataset.groupId,t=n.dataset.layerId;e&&t&&this.addLayerToGroup(e,t)}else if(n.classList.contains("create-group-item")){const t={id:"group_"+Date.now(),name:`Group ${this.groups.length+1}`,layerIds:[e],expanded:!0};this.groups.push(t),this.updateGroupUI()}document.body.removeChild(a)})),document.addEventListener("click",(function e(t){a.contains(t.target)||(document.body.removeChild(a),document.removeEventListener("click",e))}))}handleLayerAdded(e){this.layers.some((t=>t.id===e.layer.id))||this.layers.push(e.layer)}handleLayerRemoved(e){this.layers=this.layers.filter((t=>t.id!==e.layerId));for(const t of this.groups)t.layerIds=t.layerIds.filter((t=>t!==e.layerId));this.updateGroupUI()}destroy(){this.eventEmitter.off(o,this.handleLayerAdded),this.eventEmitter.off(l,this.handleLayerRemoved)}}class v{constructor(e,t){this.timeRuler=null,this.layerManager=null,this.keyframeManager=null,this.groupManager=null,this.pluginManager=e,this.eventEmitter=t,this.mainContainer=document.getElementById("timeline-control"),this.toolbarEl=document.getElementById("timeline-toolbar"),this.contentEl=document.getElementById("timeline-content"),this.contentContainerEl=document.getElementById("timeline-content-container"),this.layersContainerEl=document.getElementById("timeline-layers-container"),this.keyframesAreaEl=document.getElementById("timeline-keyframes-area"),this.timeRulerEl=document.getElementById("timeline-ruler"),this.keyframesContainerEl=document.getElementById("timeline-keyframes-container"),this.objectToolbarEl=document.getElementById("timeline-object-toolbar"),document.documentElement.style.setProperty("--time-ruler-height","30px")}initialize(){this.setupScrollSynchronization(),this.initializePlugins(),this.render()}setupScrollSynchronization(){this.keyframesContainerEl.addEventListener("scroll",(()=>{this.layersContainerEl.scrollTop=this.keyframesContainerEl.scrollTop})),this.layersContainerEl.addEventListener("scroll",(()=>{this.keyframesContainerEl.scrollTop=this.layersContainerEl.scrollTop})),this.keyframesContainerEl.addEventListener("scroll",(()=>{const e=this.timeRulerEl.querySelector("."+r);e&&(e.style.transform=`translateX(-${this.keyframesContainerEl.scrollLeft}px)`)}))}initializePlugins(){this.timeRuler=new p({container:this.timeRulerEl,eventEmitter:this.eventEmitter}),this.pluginManager.loadPlugin(this.timeRuler),this.layerManager=new y({container:this.layersContainerEl,eventEmitter:this.eventEmitter}),this.pluginManager.loadPlugin(this.layerManager),this.keyframeManager=new g({container:this.keyframesContainerEl,eventEmitter:this.eventEmitter}),this.pluginManager.loadPlugin(this.keyframeManager),this.groupManager=new f({container:this.layersContainerEl,eventEmitter:this.eventEmitter}),this.pluginManager.loadPlugin(this.groupManager)}render(){this.pluginManager.initializePlugins()}resize(){}destroy(){this.pluginManager.destroyPlugins()}}class b{constructor(e,t){this.plugins=new Map,this.eventEmitter=e,this.dataModel=t}loadPlugin(e){if(this.plugins.has(e.name))throw new Error(`Plugin ${e.name} is already loaded.`);for(const t of e.dependencies||[])if(!t.optional&&!this.plugins.has(t.name))throw new Error(`Cannot load plugin ${e.name}. Required dependency ${t.name} is not loaded.`);this.plugins.set(e.name,e)}unloadPlugin(e){const t=this.plugins.get(e);if(!t)throw new Error(`Plugin ${e} is not loaded.`);for(const[t,n]of this.plugins.entries())if(t!==e&&(n.dependencies||[]).some((t=>t.name===e&&!t.optional)))throw new Error(`Cannot unload plugin ${e}. Plugin ${t} depends on it.`);t.destroy(),this.plugins.delete(e)}getPlugin(e){return this.plugins.get(e)}initializePlugins(){const e=new Set,t=Array.from(this.plugins.keys());for(;t.length>0;){const n=t.shift(),r=this.plugins.get(n),i=(r.dependencies||[]).filter((e=>!e.optional)).every((t=>e.has(t.name)));if(i?(r.initialize(),e.add(n)):t.push(n),1===t.length&&!i)throw new Error(`Circular dependency detected for plugin ${n}`)}}destroyPlugins(){this.plugins.forEach((e=>{e.destroy()})),this.plugins.clear()}loadPlugins(){}}class k{constructor(e){this.layers=[],this.keyframes=new Map,this.groups=[],this.currentTime=0,this.duration=60,this.timeScale=1,this.eventEmitter=e}addLayer(e){this.layers.push(e),this.keyframes.set(e.id,e.keyframes||[]),this.eventEmitter.emit(o,{layer:e}),this.eventEmitter.emit(u,null)}removeLayer(e){this.layers=this.layers.filter((t=>t.id!==e)),this.keyframes.delete(e);for(const t of this.groups)t.layerIds=t.layerIds.filter((t=>t!==e));this.eventEmitter.emit(l,{layerId:e}),this.eventEmitter.emit(u,null)}renameLayer(e,t){const n=this.layers.find((t=>t.id===e));n&&(n.name=t,this.eventEmitter.emit(d,{layerId:e,newName:t}),this.eventEmitter.emit(u,null))}getLayers(){return[...this.layers]}getLayer(e){return this.layers.find((t=>t.id===e))}addKeyframe(e,t){this.keyframes.has(e)||this.keyframes.set(e,[]),this.keyframes.get(e).push(t);const n=this.layers.find((t=>t.id===e));n&&(n.keyframes||(n.keyframes=[]),n.keyframes.push(t)),this.eventEmitter.emit(h,{layerId:e,keyframe:t}),this.eventEmitter.emit(u,null)}removeKeyframe(e,t){if(!this.keyframes.has(e))return;this.keyframes.set(e,this.keyframes.get(e).filter((e=>e.id!==t)));const n=this.layers.find((t=>t.id===e));n&&n.keyframes&&(n.keyframes=n.keyframes.filter((e=>e.id!==t))),this.eventEmitter.emit("keyframeRemoved",{layerId:e,keyframeId:t}),this.eventEmitter.emit(u,null)}updateKeyframeTime(e,t,n){if(!this.keyframes.has(e))return;const r=this.keyframes.get(e).find((e=>e.id===t));if(r){r.time=n;const i=this.layers.find((t=>t.id===e));if(i&&i.keyframes){const e=i.keyframes.find((e=>e.id===t));e&&(e.time=n)}this.eventEmitter.emit(m,{layerId:e,keyframeId:t,newTime:n}),this.eventEmitter.emit(u,null)}}getKeyframes(e){return this.keyframes.has(e)?[...this.keyframes.get(e)]:[]}getAllKeyframes(){let e=[];return this.keyframes.forEach((t=>{e=e.concat(t)})),e}addGroup(e){this.groups.push(e),this.eventEmitter.emit("groupCreated",{group:e}),this.eventEmitter.emit(u,null)}removeGroup(e){this.groups=this.groups.filter((t=>t.id!==e)),this.eventEmitter.emit("groupRemoved",{groupId:e}),this.eventEmitter.emit(u,null)}renameGroup(e,t){const n=this.groups.find((t=>t.id===e));n&&(n.name=t,this.eventEmitter.emit("groupRenamed",{groupId:e,newName:t}),this.eventEmitter.emit(u,null))}getGroups(){return[...this.groups]}addLayerToGroup(e,t){const n=this.groups.find((t=>t.id===e));n&&!n.layerIds.includes(t)&&(n.layerIds.push(t),this.eventEmitter.emit("layerAddedToGroup",{groupId:e,layerId:t}),this.eventEmitter.emit(u,null))}removeLayerFromGroup(e,t){const n=this.groups.find((t=>t.id===e));n&&(n.layerIds=n.layerIds.filter((e=>e!==t)),this.eventEmitter.emit("layerRemovedFromGroup",{groupId:e,layerId:t}),this.eventEmitter.emit(u,null))}setCurrentTime(e){this.currentTime=Math.max(0,Math.min(e,this.duration)),this.eventEmitter.emit(s,{time:this.currentTime})}getCurrentTime(){return this.currentTime}setDuration(e){this.duration=Math.max(1,e),this.eventEmitter.emit("durationChanged",{duration:this.duration}),this.eventEmitter.emit(u,null)}getDuration(){return this.duration}setTimeScale(e){this.timeScale=Math.max(.1,Math.min(10,e)),this.eventEmitter.emit(a,{scale:this.timeScale})}getTimeScale(){return this.timeScale}getState(){return{currentTime:this.currentTime,timeScale:this.timeScale,duration:this.duration,layers:this.layers,groups:this.groups}}setState(e){this.currentTime=e.currentTime||0,this.timeScale=e.timeScale||1,this.duration=e.duration||60,this.layers=e.layers||[],this.groups=e.groups||[],this.keyframes.clear();for(const e of this.layers)this.keyframes.set(e.id,e.keyframes||[]);this.eventEmitter.emit("dataLoaded",{state:e})}clear(){this.layers=[],this.keyframes.clear(),this.groups=[],this.currentTime=0,this.eventEmitter.emit("dataReset",null)}}class E{constructor(){this.listeners={}}on(e,t,n){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({sender:t,listener:n})}off(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((e=>e.listener!==t)))}emit(e,t){this.listeners[e]&&this.listeners[e].forEach((e=>e.listener.call(e.sender,t)))}}var x=n(72),L=n.n(x),I=n(825),w=n.n(I),S=n(659),C=n.n(S),M=n(56),T=n.n(M),$=n(540),G=n.n($),R=n(113),A=n.n(R),P=n(115),z={};z.styleTagTransform=A(),z.setAttributes=T(),z.insert=C().bind(null,"head"),z.domAPI=w(),z.insertStyleElement=G(),L()(P.A,z),P.A&&P.A.locals&&P.A.locals;var K=n(754),D={};D.styleTagTransform=A(),D.setAttributes=T(),D.insert=C().bind(null,"head"),D.domAPI=w(),D.insertStyleElement=G(),L()(K.A,D),K.A&&K.A.locals&&K.A.locals,new class{constructor(){this.eventEmitter=new E,this.dataModel=new k(this.eventEmitter),this.pluginManager=new b(this.eventEmitter,this.dataModel),document.addEventListener("DOMContentLoaded",(()=>{this.timelineControl=new v(this.pluginManager,this.eventEmitter),this.initialize()}))}initialize(){console.log("Initializing Timeline Animation Editor..."),this.timelineControl.initialize(),window.addEventListener("resize",this.handleResize.bind(this)),console.log("Timeline Animation Editor initialized successfully")}handleResize(){this.timelineControl&&this.timelineControl.resize()}}})();